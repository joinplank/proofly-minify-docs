---
title: "SDK Usage"
description: "Use the official SDK for easier integration"
---

The Proofly API provides an official SDK for Node.js and TypeScript applications. The SDK handles authentication and provides convenient methods for making API requests. You'll need to implement job polling yourself for asynchronous operations.

## Installation

<CodeGroup>

```bash npm
npm install @plank-proofly/api
```

```bash yarn
yarn add @plank-proofly/api
```

```bash pnpm
pnpm add @plank-proofly/api
```

</CodeGroup>

## Getting Started

Initialize the client with your API key:

```typescript
import { PlankProofly } from '@plank-proofly/api';

const client = new PlankProofly({ 
  apiKey: 'sk_your_api_key_here' // starts with sk_...
});
```

## Job Management

Most operations return a job ID that you need to poll manually. Use the `jobs.retrieveStatus()` method to check job status:

```typescript
try {
  const status = await client.jobs.retrieveStatus('job-id');
  
  console.log(`Job Status: ${status.status}`); // 'queued', 'processing', 'completed', 'failed'
  
  if (status.status === 'completed') {
    console.log('Result:', status.resultData);
  } else if (status.status === 'failed') {
    console.error('Job failed:', status.errorMessage);
  }
} catch (error) {
  console.error('Error fetching job:', error);
}
```

## Profile Search

Search for Facebook profiles. This returns a job ID that you need to poll:

```typescript
// Submit the search request
const { jobId } = await client.profiles.search({
  name: 'John Doe',
  location: 'New York, NY',
  birthYear: 1990
});

// Poll for results
const pollJob = async (jobId: string) => {
  while (true) {
    const status = await client.jobs.retrieveStatus(jobId);
    
    if (status.status === 'completed') {
      return status.resultData;
    } else if (status.status === 'failed') {
      throw new Error(status.errorMessage || 'Job failed');
    }
    
    // Wait 2 seconds before polling again
    await new Promise(resolve => setTimeout(resolve, 2000));
  }
};

const result = await pollJob(jobId);
console.log('Primary Match:', result.primaryMatch);
console.log('Candidates:', result.candidates);
```

## Facebook Friend Check

Check if profiles are friends:

```typescript
// Submit the request
const { jobId } = await client.facebook.checkFriends({
  targetFacebookId: '123456789',
  candidateIds: ['987654321', '111222333']
});

// Poll for results
const result = await pollJob(jobId);
console.log('Friends:', result.friends);
```

Find mutual friends:

```typescript
// Submit the request
const { jobId } = await client.facebook.findMutualFriends({
  userIds: ['123456789', '987654321', '111222333']
});

// Poll for results
const result = await pollJob(jobId);
console.log('Mutual Friends:', result.mutualFriends);
```

## Profile Photo Verification

Verify a photo matches a Facebook profile:

```typescript
// Submit the request
const { jobId } = await client.profiles.verifyPhoto({
  photoUrl: 'https://example.com/photo.jpg',
  profileUrl: 'https://facebook.com/john.doe'
});

// Poll for results
const result = await pollJob(jobId);
console.log('Confidence:', result.confidence);
console.log('Match:', result.photoMatch);
console.log('Justification:', result.justification);
```

## Fuzzy Search

Get suggestions for names, locations, or emails:

```typescript
// Single search
const result = await client.fuzzy.search({
  type: 'name',
  value: 'Jon Doe'
});

console.log('Suggestions:', result.suggestions);
console.log('Normalized:', result.normalizedValue);

// Batch search
const batchResult = await client.fuzzy.searchBatch({
  requests: [
    { type: 'name', value: 'Jon Doe' },
    { type: 'location', value: 'NYC' },
    { type: 'email', value: 'john.doe@gmial.com' }
  ]
});

console.log('Results:', batchResult.results);
```

## Error Handling

The SDK throws errors for non-2xx responses. Handle them appropriately:

```typescript
try {
  const result = await client.profiles.search({ name: 'John Doe' });
} catch (error) {
  if (error.status === 401 || error.status === 403) {
    console.error('Invalid API Key');
  } else if (error.status === 404) {
    console.error('Resource not found');
  } else if (error.status === 429) {
    console.error('Rate limit exceeded');
  } else {
    console.error('Server error:', error.message);
  }
}
```

## Configuration Options

You can configure the SDK with additional options:

```typescript
const client = new PlankProofly({
  apiKey: 'sk_your_api_key_here',
  baseUrl: 'https://api.proofly.joinplank.com', // Optional: override base URL
  timeout: 30000, // Optional: request timeout in milliseconds
  retries: 3 // Optional: number of retries for failed requests
});
```

## TypeScript Support

The SDK is written in TypeScript and provides full type definitions:

```typescript
import { PlankProofly, JobStatus } from '@plank-proofly/api';

const client = new PlankProofly({ apiKey: 'sk_...' });

// All methods are fully typed
const { jobId } = await client.profiles.search({
  name: 'John Doe'
});

const status: JobStatus = await client.jobs.retrieveStatus(jobId);
```

## Implementing Job Polling

Since the SDK doesn't handle polling automatically, you need to implement it yourself. Here's a reusable polling function:

```typescript
interface PollOptions {
  interval?: number; // Poll interval in milliseconds (default: 2000)
  maxAttempts?: number; // Maximum polling attempts (default: 60)
  timeout?: number; // Total timeout in milliseconds (default: 120000)
}

async function pollJob(
  client: PlankProofly,
  jobId: string,
  options: PollOptions = {}
): Promise<any> {
  const {
    interval = 2000,
    maxAttempts = 60,
    timeout = 120000
  } = options;

  const startTime = Date.now();

  for (let attempt = 0; attempt < maxAttempts; attempt++) {
    // Check timeout
    if (Date.now() - startTime > timeout) {
      throw new Error('Job polling timeout');
    }

    const status = await client.jobs.retrieveStatus(jobId);

    if (status.status === 'completed') {
      return status.resultData;
    } else if (status.status === 'failed') {
      throw new Error(status.errorMessage || 'Job failed');
    }

    // Wait before next poll
    await new Promise(resolve => setTimeout(resolve, interval));
  }

  throw new Error('Max polling attempts reached');
}

// Usage example
const { jobId } = await client.profiles.search({
  name: 'John Doe'
});

const result = await pollJob(client, jobId, {
  interval: 2000,
  maxAttempts: 60,
  timeout: 120000
});
```

### Polling Best Practices

- **Poll Interval**: 2-5 seconds is recommended
- **Timeout**: Most jobs complete within 30-60 seconds, but allow up to 2 minutes for complex operations
- **Handle All Statuses**: Implement handling for `queued`, `waiting_for_browser`, `processing`, `completed`, and `failed`
- **Error Handling**: Always handle job failures and timeouts gracefully

See the [Best Practices guide](/guides/best-practices) for more detailed polling strategies.

## Package Information

- **Package**: [`@plank-proofly/api`](https://www.npmjs.com/package/@plank-proofly/api)
- **Repository**: Check the project README for GitHub link
- **Documentation**: See the project's [SDK.md](/../agent-profile-check/SDK.md) for detailed documentation

## Related Documentation

- [Quickstart Guide](/quickstart) - Get started with the API
- [API Reference](/api-reference/introduction) - Complete API documentation
- [Best Practices](/guides/best-practices) - Integration recommendations

